---
name: Image Analysis Services Removal
status: open
created: 2025-09-19T12:15:02Z
updated: 2025-09-19T12:31:54Z
github: https://github.com/pupiltree/centuryproptax/issues/14
depends_on: [001]
parallel: true
conflicts_with: [002, 004]
---

# Task: Image Analysis Services Removal

## Description

Delete the entire `/services/image_analysis/` directory and all related computer vision, OCR, and image processing dependencies. This removal eliminates unused medical imaging capabilities inherited from Krishna Diagnostics while preserving the text-based property tax chatbot functionality.

## Acceptance Criteria

- [ ] Complete removal of `/services/image_analysis/` directory and all contents
- [ ] All computer vision and OCR imports removed from other modules
- [ ] Image processing packages removed from requirements.txt
- [ ] Image analysis configurations removed from environment files
- [ ] Docker configurations updated to remove image processing containers
- [ ] Image analysis test files and sample images removed
- [ ] Zero broken imports or references to image analysis services after removal
- [ ] Property tax chatbot functionality remains fully operational

## Technical Details

### Primary Removal Targets:
- **Service Directory**: `/services/image_analysis/` - complete directory removal
- **Computer Vision**: OpenCV, PIL/Pillow image processing modules
- **OCR Services**: Tesseract, document scanning, and text extraction utilities
- **Image Storage**: Image upload handlers and file processing utilities
- **Medical Imaging**: X-ray, scan analysis, and medical image processing components

### Import Cleanup Scope:
- Remove image analysis imports from messaging handlers
- Clean computer vision imports from data acquisition modules
- Remove OCR utilities from document processing services
- Update service initialization to exclude image analysis components

### Package Dependencies to Remove:
- Computer vision libraries (opencv-python, opencv-contrib-python)
- OCR packages (pytesseract, easyocr)
- Image processing libraries (Pillow extensions, scikit-image)
- Medical imaging packages (pydicom, SimpleITK if present)
- Image format support libraries (specific to removed functionality)

### Configuration Cleanup:
- Remove image processing environment variables
- Clean image storage and upload configurations
- Remove image analysis API endpoints from routing
- Update Docker configurations to exclude image processing containers

### Safety Preservations:
- Maintain basic image handling for WhatsApp media (if used)
- Preserve document upload capabilities (if used for property tax documents)
- Keep file handling utilities that may be used for non-image files
- Maintain database schema for non-image document storage

## Implementation Steps

1. **Pre-Removal Analysis**
   - Verify dependency analysis confirms zero image analysis usage in property tax workflows
   - Identify any shared image utilities that might be used for document handling
   - Create git branch for image analysis removal operations

2. **Service Directory Removal**
   - Delete entire `/services/image_analysis/` directory
   - Remove image processing utility modules
   - Delete image analysis test files and sample images

3. **Import and Reference Cleanup**
   - Search and remove all imports referencing image analysis services
   - Clean computer vision and OCR imports from other modules
   - Update service initialization to exclude image analysis components

4. **Dependency and Configuration Cleanup**
   - Remove image processing packages from requirements.txt
   - Update Docker configurations to exclude image analysis services
   - Clean image processing environment variables and configurations

5. **Validation and Testing**
   - Run import validation to ensure no broken references
   - Execute property tax chatbot test suite
   - Verify document handling (non-image) continues to work if applicable
   - Test WhatsApp message processing with media handling preserved

## Dependencies

**Prerequisites:**
- Task 001 (Dependency Analysis) must complete successfully
- Confirmation that image analysis services have zero usage in property tax workflows
- Verification that basic file handling for property tax documents is preserved

**Parallel Execution:**
- Can run in parallel with tasks 002 (Voice Services Removal) and 004 (Instagram Cleanup)
- May conflict with tasks 002-004 if they modify shared configuration files

**Critical Considerations:**
- Ensure document upload functionality for property tax documents is not disrupted
- Preserve any basic image handling required for WhatsApp media processing
- Maintain file storage capabilities for non-image property tax documents

## Effort Estimate

**Total Time:** 4-6 hours (Day 2 afternoon)

**Breakdown:**
- Pre-removal analysis and safety verification: 1-2 hours
- Directory and file removal operations: 1-2 hours
- Import cleanup and dependency removal: 2 hours
- Validation testing and document handling verification: 1-2 hours

**Risk Level:** Medium - Need to verify document handling preservation

## Success Criteria

**Functional Validation:**
- Property tax chatbot processes WhatsApp messages correctly
- Document upload functionality (if used) continues working
- WhatsApp media handling preserved where needed
- All 6 property tax tools function without image analysis dependencies

**Technical Validation:**
- Zero Python import errors after image analysis removal
- No references to computer vision modules in remaining codebase
- Package dependency resolution successful without image processing packages
- Docker build and deployment successful without image analysis containers

**Quality Gates:**
- Complete test suite passes (excluding removed image analysis tests)
- Document handling tests pass (if applicable to property tax workflow)
- No broken imports or circular dependency errors
- Application startup successful without image analysis service initialization

## Rollback Procedures

**Git-Based Rollback:**
- Full directory restoration from git commit before removal
- Package dependency restoration via requirements.txt reset
- Configuration file restoration from previous commit

**Validation Steps:**
- Verify restored image analysis services initialize correctly
- Confirm image processing dependencies install without conflicts
- Test image analysis functionality restoration (if needed for validation)

**Emergency Procedures:**
- Immediate rollback if document handling functionality breaks
- Staged rollback to isolate image analysis vs. document handling issues
- Preservation of non-image-analysis changes made during parallel tasks

## Special Considerations

**Document Handling Preservation:**
- Identify and preserve any document upload/processing used for property tax workflows
- Maintain PDF processing capabilities if used for property tax documents
- Preserve file storage and retrieval for non-image property tax files

**WhatsApp Media Handling:**
- Preserve basic image receiving capabilities if used in WhatsApp integration
- Maintain media storage for property tax document photos (if applicable)
- Keep simple image validation without complex computer vision processing